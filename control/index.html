<!doctype html>
<html lang="es"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IoT Cart Manager Â· Control</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="../assets/css/styles.css" rel="stylesheet"></head>
<body>
<nav class="navbar navbar-light bg-white border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="../"><span class="emoji">ðŸ¤–</span>IoT Cart Manager</a>
    <div class="d-flex align-items-center gap-2">
      <button id="themeBtn" class="theme-toggle">ðŸŒ“</button>
      <a class="btn btn-outline-secondary" href="../">Dashboard</a>
      <a class="btn btn-outline-secondary active" href="./">ðŸŽ® Control</a>
      <a class="btn btn-outline-secondary" href="../monitor/">ðŸ“¡ Monitoreo</a>
    </div>
  </div>
</nav>
<div class="container py-4">
  <h3 class="mb-3">Manual Drive</h3>
  <div class="mb-3">
    <label class="form-label">Speed: <span id="spdLabel">70</span>%</label>
    <input type="range" min="0" max="100" value="70" id="speed" class="form-range">
  </div>
  <div class="drive-pad my-3">
    <button class="drive-btn" data-move="forward_left">â†–</button>
    <button class="drive-btn" data-move="forward">â†‘</button>
    <button class="drive-btn" data-move="forward_right">â†—</button>
    <button class="drive-btn" data-move="rotate_left">â†º</button>
    <button class="drive-btn stop" data-move="stop">âœ‹</button>
    <button class="drive-btn" data-move="rotate_right">â†»</button>
    <button class="drive-btn" data-move="backward_left">â†™</button>
    <button class="drive-btn" data-move="backward">â†“</button>
    <button class="drive-btn" data-move="backward_right">â†˜</button>
  </div>
  <div class="d-flex gap-2">
    <button id="btnDemoL" class="btn btn-outline-secondary">Giro 360 Izquierda</button>
    <button id="btnDemoR" class="btn btn-outline-secondary">Giro 360 Derecha</button>
  </div>
  <div class="card mt-4"><div class="card-body"><h5 class="card-title">Command Log</h5><div class="log" id="log"></div></div></div>
</div>
<script type="module">
import "../assets/js/config.js";
import { sendMove, sendDemo } from "../assets/js/api.js";
const spd=document.getElementById("speed"); const spdLabel=document.getElementById("spdLabel"); const log=document.getElementById("log");
spd.addEventListener("input",()=>spdLabel.textContent=spd.value);
function addLog(txt,err=false){ const line=document.createElement("div"); const stamp=new Date().toLocaleTimeString(); line.innerHTML=`<span class="stamp">[${stamp}]</span> ${txt}`; if(err) line.style.color="#ffb4b4"; log.appendChild(line); log.scrollTop=log.scrollHeight; }
document.querySelectorAll(".drive-btn").forEach(btn=>{ btn.addEventListener("click", async()=>{ const dir=btn.dataset.move; try{ await sendMove(dir,+spd.value); addLog(`"${dir}" (${spd.value}%) âœ…`);} catch(e){ addLog(`ERROR "${dir}": ${e}`, true);} }); });
document.getElementById("btnDemoL").onclick=async()=>{ try{ await sendDemo("spin_left",10); addLog(`Demo "spin_left" âœ…`);}catch(e){ addLog(`ERROR demo: ${e}`, true);} };
document.getElementById("btnDemoR").onclick=async()=>{ try{ await sendDemo("spin_right",10); addLog(`Demo "spin_right" âœ…`);}catch(e){ addLog(`ERROR demo: ${e}`, true);} };
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body></html>
